# 项目总览

本文件为 JuliaCanvas 项目的总览，面向AI助手和新开发者，帮助快速了解项目全貌。

## 项目愿景
- JuliaCanvas 是一个独立开发、和AI协作开发的项目，是一个画布式的Julia 代码环境，开发这个项目旨在探索画布式、交互式、声明式创作工具的开发与AI协作模式。
- 项目起步于开发者对一个更大的项目（Para和Parasee）更大愿景的探索，因项目规模较大、技术栈储备有限，需要采用 AI 协作开发、快速原型验证、当场学习技术的路线。
- 目标是以 Julia 开发工具为例，学习、验证和展示"画布式、交互式、声明式（响应式）创作"的理念和技术。
- 关键设计理念详解：
   - 画布式编程：在画布上创建和编辑代码块，支持代码块的拖拽、缩放、旋转等操作。代码块相互组合成一个完整的工程。代码块默认能影响“全局语义”，但可以设置为“局部语义”，只影响自己，并通过手动连接来明确背景输入、变量输出的依赖关系。
   - 交互式编程：代码块有交互式特性，支持代码块的运行、调试、可视化等操作。可以将变量声明为“交互式变量”，通过滑动条、输入框、勾选框等控件来交互式地编辑变量。
   - 声明式/响应式创作：构建一个"声明式/响应式"的创作环境，尽可能的将某个元素的数据变更自动同步计算到所有依赖元素上，减少创作过程的重复劳动。这里的创作是一个相当广义的概念，包括但不限于编程、平面设计、动画、视频、音频、3D 等。

## 项目目标
### 核心目标
- 实现在一个统一的画布环境下结合代码块编辑与可视化展示。
- 多技术栈原型探索，积累最佳实践。
- 通过与 Bernard.jl（开发者的另一个项目——一个可以通过 Julia 代码创建工程化 Desmos 图表的库项目）集成，展示代码与可视化的无缝衔接。

### 开发者发展目标
- **技术栈评估与学习**：通过多个子工程探索不同前端技术栈组合，评估优缺点。
- **设计理念学习与验证**：为开发者提供学习新技术的平台，验证理念可行性。
- **为 Parasee 项目奠基**：积累经验和技术储备，为更大规模的 Parasee 项目做准备。
- **AI 协作开发模式探索**：建立有效的人机协作开发流程，积累 AI 辅助开发的最佳实践。

## 子项目简介

我们通过创建多个子项目的方式，逐步探索不同的技术栈组合，验证不同的设计理念。以下是目前的子项目列表：

- example-react-flow：基于 React Flow 库的原型。[更多信息](example-react-flow/目标描述与任务进度.md)
- 其它子项目：预留，后续补充。

> 各个子项目的具体信息请参见 working-notes 文件夹下以子项目为名的各个子文件夹。

## 技术路线探索

我们正在探索各个可能的技术栈组合：

- TypeScript + Vite + pnpm
- React Flow、Zustand、TailwindCSS 或者其他库和工具等。

> 详见 [通用技术笔记.md](通用技术笔记.md)。


## 项目当前状态### 已完成的核心功能 ✅- **基础画布系统**: React Flow集成，自定义节点和边- **Julia后端集成**: 完整的HTTP API服务器，支持代码解析和执行- **变量控件系统**: @input/@output语法，支持滑动条、输入框、布尔开关- **交互系统**: 多模式工具栏，无锚点连接，键盘快捷键- **状态管理**: 自动保存/恢复，导入/导出功能### 技术栈选择确认基于实际开发经验，项目采用以下技术栈：- **前端**: React 19.0 + TypeScript + Vite + React Flow + TailwindCSS + Zustand- **后端**: Julia + HTTP.jl + JSON3.jl- **构建**: pnpm + Vite## 主要协作方式- 以 working-notes 文件夹作为 AI 与人类开发者的知识库和沟通桥梁。- 所有背景、进度、任务、决策等信息均应在此归档。 - 谨记，working-notes 文件夹是面向AI的，维护 working-notes 文件夹时需要确保一个新的AI助手实例在接手任务和回答开发者的问题之前能通过 working-notes 了解到所有所需的背景信息。> 详细协作规范见 [AI协作指南.md](AI协作指南.md)。 

## 历史记录

详见 [历史沿革.md](历史沿革.md)。

## 补充信息
- 开发者有前端技术栈经验，但对画布式应用的相关技术栈经验较少。
- 如果开发者修改了 working-notes 文档，文档可能会跟实际代码工程脱节。默认以文档为准。
- 更多信息可见 [FAQ.md](FAQ.md)。

## 最新需求与任务分解

### 项目定位与目标
- 打造一个基于 Julia 的画布式编程环境，支持变量、表达式、公式对象的可视化、交互式编辑与复合，最终可导出并预览 Desmos 图像。
- 每个代码节点既是可编辑的 Julia 代码单元，也是可交互的数学对象或控件，支持变量联动、公式复用、图形化引用与自动依赖追踪。
- 后端依赖自研 Bernard.jl 库，负责表达式捕获、公式对象生成、Desmos 结构导出等核心逻辑。

### 阶段性任务规划
1. 基础画布与节点能力升级
   - 代码节点支持 Julia 语法高亮与基本编辑
   - 节点数据结构扩展，支持变量、表达式、公式对象等类型标记
   - 节点下方控件区基础实现（滑动条、输入框、勾选框等，自动识别变量类型）
   - 节点间依赖关系自动追踪与高亮显示
2. Bernard.jl 后端集成与表达式解析
   - 设计前后端 API 协议（前端传代码片段，后端返回结构化对象/控件描述/依赖信息）
   - 集成 Bernard.jl，支持表达式捕获、变量/公式对象识别
   - 前端根据后端返回动态渲染控件区和 Desmos 预览
3. Desmos 预览与导出
   - 节点级 Desmos 预览（内嵌或新窗口）
   - 支持导出 Desmos JSON/LaTeX
   - 支持批量导出/导入/分享
4. 高级交互与可扩展性
   - 变量动画与控件联动
   - 匿名表达式自动命名与一键重命名
   - 图形化引用与依赖关系可视化
   - 支持更多类型（向量、矩阵、函数等）和控件（颜色选择、下拉菜单等）
5. 画布状态持久化与版本兼容
   - 画布状态自动保存/恢复
   - 导入导出 JSON，带版本号
   - 兼容未来节点/边/控件类型扩展

### Bernard.jl 的角色与前后端协作
- Bernard.jl 负责捕获 Julia 代码中的表达式、变量定义、公式对象等，并生成结构化的数学对象。
- 提供 API 支持前端控件区的类型识别与控件生成。
- 支持公式对象的复合、列表化、属性扩展等操作。
- 实现 Desmos 结构的导出与预览接口。
- 前端负责画布交互、控件渲染、依赖追踪等，后端 Bernard.jl 负责表达式解析、公式对象生成和 Desmos 集成。
- 前后端通过 API 通信，前端传递代码片段，后端返回结构化对象和可视化数据。

## 2025年5月项目目标调整

- **战略重心转移**：不再以"Para/Parasee完整技术栈探索"为首要目标，而是聚焦于"Julia+Bernard.jl+Desmos+React Flow"原型的快速落地。
- **叙事与团队建设**：优先打造一个能直观展示"画布式编程与图象创作"理念的原型，便于对外讲故事、吸引和说服新成员。
- **面向Desmos圈层**：该原型将极大提升Desmos爱好者的生产力和创作体验，让他们无需专业技能即可高效参与动画、艺术、设计等工作，也为团队吸纳Desmos背景的成员提供了实际参与和成长的路径。
- **后续可扩展性**：虽然未来Para/Parasee可能与Julia、Desmos无关，但本原型的理念和体验可迁移，是团队叙事和技术积累的重要资产。