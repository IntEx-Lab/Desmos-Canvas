> 说明：本文件内容已迁移至 working-notes 其它文档（如《项目总览.md》《通用技术笔记.md》《example-react-flow/目标功能特性.md》等），本文件仅作历史备份，后续请查阅新文档。

# 项目介绍

JuliaCanvas 是一个独立开发、和AI协作开发的项目。本文档是面向AI助手的介绍文档。

开发者正在开发一个更大的项目（Para和Parasee），但是由于项目规模较大，开发者技术栈储备不足，需要走AI协作开发、快速原型验证、当场学习技术的路线。

目前需要实现一个原型，暂时命名为 JuliaCanvas。以Julia开发工具为例，用来学习、验证和展示"画布式、交互式、声明式创作"的理念和技术。

根据前面一段时间的开发经验，开发者认为我们实际上有多种技术栈/库/路线可以选择，但是开发者都不太熟悉，所以或许我们应该把这些技术栈/库/路线都尝试一遍，整多个子工程，学习理解之后再决定最终的路线。

JuliaCanvas 完成后，可以和另一个小项目（使用Julia代码创建工程化Desmos图表的一个Julia库项目）联动，简单地实现和展示一个目标：在画布上同时放入代码和交互式图表，在画布里用代码生成交互式图表（或者我更愿意称之为Demonstration-lets）。这便是Parasee项目的目标。

由于开发者需要和AI协作开发，故需要 working-notes 文件夹用于放置"笔记"式的信息文件，供开发者和AI助手同时使用，为每一个新的AI实例提供背景信息，以便 AI 理解和工作。请 AI 合理使用 working-notes 文件夹，以便开发者和 AI 可以随时查阅和更新信息。

## Para / Parasee 项目介绍

（略 待补充）

## 项目概述

JuliaCanvas 是一个画布式、交互式、声明式创作工具的原型项目，旨在探索和验证在一个统一画布环境中结合代码编辑和可视化展示的可能性。该项目是 Para/Parasee 更大愿景的一部分，通过与另一个项目——Bernard.jl，一个使用 Julia 代码创建工程化 Desmos 图表的库项目的集成，展示如何在画布上同时放置代码和交互式图表，实现代码与可视化的无缝衔接。

JuliaCanvas 通过多个子工程探索不同的技术栈和实现方案，以便在实践中评估各种技术的优缺点，为最终的技术选型提供依据。项目强调快速原型验证和迭代开发，通过与 AI 的协作开发模式，加速学习和实现过程。

## 核心目标

本体目标：

1. **画布式环境**：

2. **声明式设计**：确保画布上的组件能按照依赖关系对某一部分的变动进行实时重计算、实时更新。

3. **与Bernard.jl集成 - 代码与可视化集成**：
    - 升级JuliaCanvas的画布环境，支持各类元素（代码、Desmos图表、文本等）的自由放置和交互。
	- 实现代码编辑器与可视化图表的无缝集成，使用户能够通过 Julia 代码直接生成和控制交互式图表。

开发者发展目标：

1. **技术栈评估与学习**：通过多个子工程探索不同的前端技术栈组合，评估它们在实现画布应用方面的优缺点。

2. **设计理念学习与验证**：为开发者提供学习新技术的平台，同时验证"画布式、交互式、声明式创作"的理念在实际应用中的可行性。

3. **为 Parasee 项目奠基**：通过 JuliaCanvas 的开发，积累经验和技术储备，为更大规模的 Parasee 项目做准备。

4. **AI 协作开发模式探索**：建立有效的人机协作开发流程，提高开发效率，同时积累 AI 辅助开发的最佳实践。

## 补充信息

- 开发者有前端技术栈经验，但对画布式应用的相关技术栈经验较少。
- 如果开发者修改了项目介绍，介绍文本可能会跟实际代码工程脱节。默认以文档为准。

## 技术栈探索

### 默认技术栈 / 已确定需要选择的技术栈：

- TypeScript 作为编程语言
- Vite 作为构建工具
- pnpm 作为包管理工具


### 可选技术栈：

**核心技术：**

1. **基础框架**（选择一种）：
   - **React**：最流行的前端库，生态丰富，学习曲线中等，适合复杂应用
   - **Vue**：轻量级框架，学习曲线平缓，适合快速原型开发
   - **Svelte**：下一代前端框架，编译时框架，性能出色，学习曲线较低

2. **画布/图形渲染选项**（选择一种）：
   - **React Flow**：专为节点-边连接图设计，有丰富的交互功能和事件系统。基于React框架，适合流程图类应用
   - **D3.js**：强大的可视化库，适合复杂的图表和图形，学习曲线较陡
   - **G6**（蚂蚁集团开源）：国产图可视化引擎，文档中文支持好，适合关系图应用
   - **Konva.js**：轻量级HTML5 Canvas库，适合自定义绘图需求，性能良好
   - **Fabric.js**：功能强大的Canvas库，支持对象模型和事件系统，适合交互式绘图
   - **Three.js**：3D图形库，适合需要3D渲染的场景，学习曲线较高
   - **PixiJS**：高性能2D渲染引擎，适合游戏和动画应用

3. **状态管理**：
   - **Redux**：最流行的状态管理库，适合大型应用，但样板代码较多
   - **Zustand**：轻量级状态管理库，比Redux简单，适合原型开发。和Immer配合使用可以轻松处理嵌套状态更新
   - **Jotai**：原子化状态管理，对反应式更新支持良好，适合小型到中型应用
   - **MobX**：响应式状态管理，适合需要自动更新的场景，学习曲线较低

**辅助工具：**

1. **UI组件库**：
   - **Ant Design**：国产优质组件库，文档齐全且有中文支持，适合企业级应用
   - **Material UI**：遵循Material Design规范，国际化支持好
   - **Chakra UI**：可访问性优秀的组件库，适合快速开发
   - 轻量级选择：**TailwindCSS** + **headlessUI**：高度可定制，适合设计系统

2. **数据处理**：
   - **Immer**：简化不可变数据处理，适合嵌套状态更新
   - **Lodash**：实用工具函数集，提供常用工具方法
   - **Ramda**：函数式编程工具库，适合复杂数据处理

3. **开发工具**：
   - **ESLint** + **Prettier**：代码质量和格式化，保持代码一致性
   - **Vitest**：单元测试框架，与Vite集成良好
   - **Storybook**：组件开发环境，适合UI组件开发
   - **Playwright**：端到端测试工具，适合交互测试

### 子工程/应用示例1: example-react-flow

**这是第一个原型示例，位于 `example-react-flow` 文件夹中。**

使用技术栈：

- 核心：
	- pnpm 作为包管理工具
    - React + TypeScript + Vite
    
- 单选项：
    - React Flow
    - Zustand
    - TailwindCSS + headlessUI
    
- 可选项：
    - Immer
    - Lodash
    
    - ESLint + Prettier：代码质量和格式化
    - Vitest：单元测试框架

#### 功能特性

1. **自定义文本节点（代码片段节点，风格参考 Exalidraw）**：
   - 节点默认无背景、无边框，仅在选中时显示边框，整体风格参考 Exalidraw。
   - 使用等宽字体（如 'Fira Mono', 'Consolas', 'Menlo', monospace），优化代码可读性。
   - 双击节点可进入编辑模式，支持多行代码输入。
   - 节点下方有专门区域用于显示该代码片段的求值/执行结果，为代码片段提供上下文信息。
   - 节点本体承担主要交互区域，便于后续扩展更多功能。

2. **智能连接系统（无锚点连接体验，参照 Exalidraw）**：
   - 取消固定连接点（handle）的显式交互，用户在"连接模式"下可直接在节点本体上按下鼠标并拖动以创建连接，无需操作具体锚点。
   - 连接点位置由系统根据节点间的相对位置智能计算（如 Exalidraw），后续可扩展为用户微调连接点位置。
   - 连接线使用贝塞尔曲线，提供流畅的视觉效果。
   - 支持动画连接线，可视化数据流动方向。
   - 为兼容 React Flow 的底层机制，每个节点仍有一个隐藏 handle（id 统一为 'main'），所有边都通过该 handle 进行连接，底层数据结构与 React Flow 生态完全兼容，便于后续扩展和维护。
   - 这样做的优势：用户界面更简洁，操作更自然，且为后续实现 Exalidraw 式的智能连接点和用户微调功能打下基础。

3. **多模式工具栏**：
   - 实现了模式切换工具栏，支持选择、文本和连接三种操作模式
   - 选择模式：用于移动和选择节点
   - 文本模式：用于在画布上创建新的代码节点
   - 连接模式：用于在节点之间创建连接关系
   - 直观的视觉反馈，清晰指示当前活动模式
